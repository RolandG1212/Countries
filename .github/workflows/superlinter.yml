name: Lint Code

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  lint:
    runs-on: windows-latest
    timeout-minutes: 5

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18' # Specify the version of Node.js you want to use

    - name: Install dependencies
      run: |
        npm i
    
    - name: Start npm in background
      run: |
        nohup npm start &  # Run npm start in the background using 'nohup' and '&'
        echo $! > npm_pid.txt  # Save the process ID for later use

    - name: Do some other work
      run: |
        echo "Performing other tasks while npm start runs in the background"
        # Add any additional tasks here

    - name: Stop npm start gracefully
      run: |
        kill $(cat npm_pid.txt)  # Stop the background process using its saved PID
        wait $(cat npm_pid.txt)  # Ensure the process is fully terminated before proceeding

    - name: Clean up and finish
      run: |
        echo "npm start has been stopped, and all tasks are complete"
